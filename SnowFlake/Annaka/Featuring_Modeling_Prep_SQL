DELETE FROM PURCHASE_ORDER_HISTORY
WHERE COMPANY_CODE_ID IS NULL;

-- check
SELECT *
FROM PURCHASE_ORDER_HISTORY
LIMIT 100;

-- check 2
SELECT 
    COUNT(*) - COUNT(PURCHASE_DOCUMENT_ID) AS PURCHASE_DOCUMENT_ID_Null_Count, --0
    COUNT(*) - COUNT(CREATE_DATE_ML) AS CREATE_DATE_Null_Count, --0
    COUNT(*) - COUNT(COMPANY_CODE_ID) AS COMPANY_CODE_ID_Null_Count, --0
    COUNT(*) - COUNT(VENDOR_ID) AS VENDOR_ID_Null_Count, --198809
    COUNT(*) - COUNT(POSTAL_CD) AS PLANNED_DELIVERY_DAYS_Null_Count, --200368
--    COUNT(*) - COUNT(RELEASE_DATE_ML) AS PLANNED_DELIVERY_DAYS_Null_Count, --1075853
    COUNT(*) - COUNT(PURCHASE_DOCUMENT_ITEM_ID) AS PLANNED_DELIVERY_DAYS_Null_Count, -- 0
    COUNT(*) - COUNT(MATERIAL_ID) AS PLANNED_DELIVERY_DAYS_Null_Count, --520504
    COUNT(*) - COUNT(SUB_COMMODITY_DESC) AS PLANNED_DELIVERY_DAYS_Null_Count, --1025
    COUNT(*) - COUNT(PLANT_ID) AS PLANNED_DELIVERY_DAYS_Null_Count, --37169
--    COUNT(*) - COUNT(POR_DELIVERY_DATE_ML) AS PLANNED_DELIVERY_DAYS_Null_Count, --804579
    COUNT(*) - COUNT(FIRST_GR_POSTING_DATE_ML) AS PLANNED_DELIVERY_DAYS_Null_Count, --130276
--    COUNT(*) - COUNT(DELIVERY_DATE) AS DELIVERY_DATE_Null_Count, --45651
    COUNT(*) - COUNT(INBOUND_DELIVERY_ITEM_ID) AS PLANNED_DELIVERY_DAYS_Null_Count, --0
    COUNT(*) - COUNT(INBOUND_DELIVERY_ID) AS PLANNED_DELIVERY_DAYS_Null_Count, --679505
    COUNT(*) - COUNT(PLANNED_DELIVERY_DAYS) AS PLANNED_DELIVERY_DAYS_Null_Count --0
FROM 
    PURCHASE_ORDER_HISTORY;


UPDATE PURCHASE_ORDER_HISTORY
SET PLANNED_DELIVERY_DAYS = 7
WHERE PLANNED_DELIVERY_DAYS IS NULL;


-- CREATE NEW COLUMN BOOLEAN FOR LATE OR NOT
ALTER TABLE PURCHASE_ORDER_HISTORY
ADD LATE BOOLEAN;

UPDATE PURCHASE_ORDER_HISTORY
SET LATE = CASE WHEN DELIVERY_DATE_ML <= FIRST_GR_POSTING_DATE_ML THEN FALSE ELSE TRUE END;
